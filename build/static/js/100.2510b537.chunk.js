(self["webpackJsonpsyzoj-ng-app"]=self["webpackJsonpsyzoj-ng-app"]||[]).push([[100],{1037:function(e,s,t){"use strict";t.r(s);var n=t(10),r=t.n(n),c=t(15),i=t(19),a=t(1),o=t(0),u=t(1804),d=t(1799),l=t(55),b=t(1560),p=t.n(b),f=t(183),j=t(181),m=t(9),O=t(22),h=t(912),w=t(842),x=t(182),v=t(37),k=function(e){var s,t=Object(O.i)("discussion_edit"),n=Object(O.k)();Object(o.useEffect)((function(){m.a.enterNewPage(e.discussion?"".concat(t(".title_update")," #").concat(e.discussion.meta.id):t(".title_new"))}),[m.a.locale,e.discussion]);var d=Object(O.l)(),l=Object(o.useState)(e.discussion?e.discussion.meta.title:""),b=Object(i.a)(l,2),f=b[0],v=b[1],k=Object(o.useState)(e.discussion?e.discussion.content:""),g=Object(i.a)(k,2),D=g[0],y=g[1];function C(){return(C=Object(c.a)(r.a.mark((function s(){var c,i,a,o,u,l;return r.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!e.discussion){s.next=6;break}return s.next=3,j.c.discussion.updateDiscussion({discussionId:e.discussion.meta.id,title:f,content:D});case 3:s.t0=s.sent,s.next=9;break;case 6:return s.next=8,j.c.discussion.createDiscussion({problemId:null===(c=e.problem)||void 0===c||null===(i=c.meta)||void 0===i?void 0:i.id,title:f,content:D},d("CreateDiscussion"));case 8:s.t0=s.sent;case 9:if(a=s.t0,o=a.requestError,u=a.response,!o){s.next=16;break}x.a.error(o(t)),s.next=22;break;case 16:if(!u.error){s.next=20;break}x.a.error(t(".errors.".concat(u.error))),s.next=22;break;case 20:return l=e.discussion?e.discussion.meta.id:u.discussionId,s.abrupt("return",(function(){return n.navigate("/d/".concat(l))}));case 22:return s.abrupt("return",!1);case 23:case"end":return s.stop()}}),s)})))).apply(this,arguments)}return Object(a.jsxs)(a.Fragment,{children:[Object(w.getBreadcrumb)(e.discussion?e.discussion.problem:e.problem,t,null,Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(u.a.Divider,{icon:"right angle"}),Object(a.jsx)(u.a.Section,{children:e.discussion?"".concat(t(".header.update")," #").concat(e.discussion.meta.id):t(".header.add")})]})),Object(a.jsx)(h.DiscussionEditor,{className:p.a.editor,type:e.discussion?"UpdateDiscussion":"NewDiscussion",publisher:(null===(s=e.discussion)||void 0===s?void 0:s.publisher)||m.a.currentUser,title:f,content:D,onChangeTitle:function(e){return e.length<=80&&v(e)},onChangeContent:y,onCancel:function(){return n.navigate("/d/".concat(e.discussion.meta.id))},onSubmit:function(){return C.apply(this,arguments)},noSubmitPermission:e.discussion&&!e.discussion.permissions.includes("Modify")})]})};k=Object(l.a)(k),s.default={new:Object(f.c)(function(){var e=Object(c.a)(r.a.mark((function e(s){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.a.currentUser&&m.a.serverPreference.security.allowEveryoneCreateDiscussion||m.a.currentUserHasPrivilege("ManageDiscussion")){e.next=2;break}throw new f.a(Object(v.c)("discussion_edit.errors.PERMISSION_DENIED"));case 2:return e.next=4,Object(c.a)(r.a.mark((function e(){var t,n,c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=s.params.problemId)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,j.c.problem.getProblem({id:Number(t)||0,localizedContentsOfLocale:m.a.locale,localizedContentsTitleOnly:!0});case 5:if(n=e.sent,c=n.requestError,i=n.response,!c){e.next=12;break}throw new f.a(c,{showRefresh:!0,showBack:!0});case 12:if(!i.error){e.next=14;break}throw new f.a(Object(v.c)("discussion_edit.errors.".concat(i.error)));case 14:return e.abrupt("return",{meta:i.meta,title:i.localizedContentsOfLocale.title});case 15:case"end":return e.stop()}}),e)})))();case 4:return t=e.sent,e.abrupt("return",Object(a.jsx)(k,{problem:t},Object(d.a)()));case 6:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}()),edit:Object(f.c)(function(){var e=Object(c.a)(r.a.mark((function e(s){var t,n,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.c.discussion.getDiscussionAndReplies({locale:m.a.locale,discussionId:Number(s.params.id)||0,getDiscussion:!0});case 2:if(t=e.sent,n=t.requestError,c=t.response,!n){e.next=9;break}throw new f.a(n,{showRefresh:!0,showBack:!0});case 9:if(!c.error){e.next=11;break}throw new f.a(Object(v.c)("discussion_edit.errors.".concat(c.error)));case 11:return e.abrupt("return",Object(a.jsx)(k,{discussion:c.discussion},Object(d.a)()));case 12:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}())}}}]);
//# sourceMappingURL=100.2510b537.chunk.js.map