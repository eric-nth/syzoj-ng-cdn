(self["webpackJsonpsyzoj-ng-app"]=self["webpackJsonpsyzoj-ng-app"]||[]).push([[149],{1099:function(e,t,n){"use strict";n.r(t);var c=n(10),a=n.n(c),r=n(179),s=n(29),o=n(80),i=n(19),j=n(15),l=n(1),u=n(0),b=n(1803),O=n(618),d=n(1807),f=n(1790),h=n(1795),m=n(99),x=n(930),p=n(1100),g=n.n(p),k=n(181),v=n(183),w=n(37),C=n(22),N=n(931),y=n(9),S=n(912),_=n(109),E=n(734),A=n(163),L=n(989),H=n(756),W=n(182);function R(){return z.apply(this,arguments)}function z(){return(z=Object(j.a)(a.a.mark((function e(){var t,n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.c.homepage.getHomepageSettings();case 2:if(t=e.sent,n=t.requestError,c=t.response,!n){e.next=9;break}throw new v.a(n,{showRefresh:!0,showBack:!0});case 9:if(!c.error){e.next=11;break}throw new v.a(Object(w.c)("home_settings.errors.".concat(c.error)),{showRefresh:!0,showBack:!0});case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=function(e){var t=Object(C.i)("home_settings");Object(u.useEffect)((function(){y.a.enterNewPage(t(".title"),null,!1)}),[y.a.locale]);var n=Object(C.d)(),c=Object(i.a)(n,2),p=(c[0],c[1]),v=Object(u.useState)(e.settings.notice.enabled),w=Object(i.a)(v,2),R=w[0],z=w[1],B=Object(u.useState)((function(){return 0===Object.keys(e.settings.notice.contents).length?Object(o.a)({},y.a.locale,""):e.settings.notice.contents})),D=Object(i.a)(B,2),F=D[0],T=D[1],q=Object(u.useState)(Object.keys(F)[0]),I=Object(i.a)(q,2),J=I[0],P=I[1],G=Object(u.useState)((function(){return 0===Object.keys(e.settings.annnouncements.items).length?Object(o.a)({},y.a.locale,[]):Object.fromEntries(Object.entries(e.settings.annnouncements.items).map((function(t){var n=Object(i.a)(t,2);return[n[0],n[1].map((function(t){return e.annnouncementDiscussions.find((function(e){return e.id===t}))}))]})))})),K=Object(i.a)(G,2),M=K[0],Q=K[1],U=Object(u.useState)(Object.keys(M)[0]),V=Object(i.a)(U,2),X=V[0],Y=V[1];function Z(e,t,n){return function(c){p(!0),e((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},c,n))})),t(c)}}function $(e,t){return function(){e((function(e){var n=Object.entries(e);return Object.fromEntries([n.find((function(e){return Object(i.a)(e,1)[0]===t}))].concat(Object(r.a)(n.filter((function(e){return Object(i.a)(e,1)[0]!==t})))))}))}}function ee(e,t,n){return function(){e((function(e){var c=Object.keys(e),a=c.indexOf(n);return a===c.length-1?t(c[a-1]):t(c[a+1]),Object.fromEntries(Object.entries(e).filter((function(e){return Object(i.a)(e,1)[0]!==n})))}))}}var te=Object(u.useState)((function(){return x.a.dump(e.settings.hitokoto)})),ne=Object(i.a)(te,2),ce=ne[0],ae=ne[1],re=Object(u.useState)((function(){return x.a.dump(e.settings.countdown)})),se=Object(i.a)(re,2),oe=se[0],ie=se[1],je=Object(u.useState)((function(){return x.a.dump(e.settings.friendLinks)})),le=Object(i.a)(je,2),ue=le[0],be=le[1],Oe=Object(C.b)(Object(j.a)(a.a.mark((function e(){var n,c,r,s,o,j,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.a.load(ce),c=x.a.load(oe),r=x.a.load(ue),s=Object.fromEntries(Object.entries(M).map((function(e){var t=Object(i.a)(e,2);return[t[0],t[1].map((function(e){return e.id}))]}))),e.next=6,k.c.homepage.updateHomepageSettings({settings:{notice:{enabled:R,contents:F},annnouncements:{items:s},hitokoto:n,countdown:c,friendLinks:r}});case 6:o=e.sent,j=o.requestError,l=o.response,j?W.a.error(j(t)):l.error?W.a.error(t(".errors.".concat(l.error),{id:l.errorDiscussionId})):(p(!1),W.a.success(t(".success")));case 10:case"end":return e.stop()}}),e)})))),de=Object(i.a)(Oe,2),fe=de[0],he=de[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:g.a.headerWrapper,children:[Object(l.jsx)(b.a,{as:"h1",icon:"setting",content:t(".header"),className:"withIcon"}),Object(l.jsx)(O.a,{loading:fe,primary:!0,content:t(".submit"),onClick:he})]}),Object(l.jsx)(b.a,{className:g.a.subHeader,as:"h3",content:Object(l.jsxs)(l.Fragment,{children:[t(".notice.header"),Object(l.jsx)(d.a,{toggle:!0,checked:R,onChange:function(e,t){var n=t.checked;return z(n)}})]})}),Object(l.jsx)(N.a,{className:g.a.noticeLocalizeTab+(R?"":" "+g.a.disabled),locales:Object.keys(F),activeLocale:J,onSetActiveLocale:P,onAddLocale:Z(T,P,""),item:function(e,n,c){return Object(l.jsxs)("div",{className:g.a.noticeTab,children:[Object(l.jsxs)("div",{className:g.a.buttons,children:[!n&&Object(l.jsx)(O.a,{content:t(".set_default_locale"),onClick:$(T,e)}),!c&&Object(l.jsx)(f.a,{trigger:Object(l.jsx)(O.a,{negative:!0,content:t(".delete_locale")}),content:Object(l.jsx)(O.a,{negative:!0,content:t(".confirm_delete_locale"),onClick:ee(T,P,e)}),on:"click",position:"top center"})]}),Object(l.jsx)("div",{children:Object(l.jsx)(S.DiscussionEditor,{type:"RawEditor",content:F[e],onChangeContent:function(t){p(!0),T((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(o.a)({},e,t))}))},placeholder:t(".notice.placeholder")})})]})}}),Object(l.jsx)(b.a,{as:"h3",content:t(".annnouncements.header")}),Object(l.jsx)(N.a,{locales:Object.keys(M),activeLocale:X,onSetActiveLocale:Y,onAddLocale:Z(Q,Y,[]),item:function(e,n,c){return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(h.a,{unstackable:!0,className:g.a.table,basic:!0,children:[Object(l.jsx)(h.a.Header,{children:Object(l.jsxs)(h.a.Row,{children:[Object(l.jsx)(h.a.HeaderCell,{width:1,className:g.a.noWrap,textAlign:"center",children:"#"}),Object(l.jsx)(h.a.HeaderCell,{children:t(".annnouncements.title")}),Object(l.jsx)(h.a.HeaderCell,{width:1,className:g.a.noWrap,textAlign:"center",children:t(".annnouncements.date")}),Object(l.jsx)(h.a.HeaderCell,{width:1,className:g.a.noWrap,textAlign:"center",children:t(".annnouncements.operations")})]})}),Object(l.jsxs)(h.a.Body,{children:[M[e].map((function(n){return Object(l.jsxs)(h.a.Row,{children:[Object(l.jsx)(h.a.Cell,{textAlign:"center",className:g.a.noWrap,children:n.id}),Object(l.jsx)(h.a.Cell,{children:Object(l.jsx)(_.a,{children:Object(l.jsx)(C.a,{href:Object(E.b)(n),target:"_blank",children:Object(E.a)(n.title,t)})})}),Object(l.jsx)(h.a.Cell,{width:1,className:g.a.noWrap,children:Object(A.a)(n.publishTime,!0)[1]}),Object(l.jsx)(h.a.Cell,{className:g.a.noWrap,textAlign:"center",children:Object(l.jsx)(m.a,{className:g.a.operation,name:"delete",onClick:function(){p(!0),Q((function(t){return Object(s.a)(Object(s.a)({},t),{},Object(o.a)({},e,t[e].filter((function(e){return e.id!==n.id}))))}))}})})]},n.id)})),Object(l.jsx)(h.a.Row,{children:Object(l.jsx)(h.a.Cell,{colSpan:4,children:Object(l.jsxs)("div",{className:g.a.footer,children:[Object(l.jsx)(b.a,{size:"tiny",children:t(".annnouncements.add")}),Object(l.jsx)(L.a,{onResultSelect:function(t){var n=t.meta;p(!0),Q((function(t){return t[e].some((function(e){return e.id===n.id}))?t:Object(s.a)(Object(s.a)({},t),{},Object(o.a)({},e,[].concat(Object(r.a)(t[e]),[n]).sort((function(e,t){return t.id-e.id}))))}))}}),Object(l.jsx)("div",{className:g.a.space}),!n&&Object(l.jsx)(O.a,{content:t(".set_default_locale"),onClick:$(Q,e)}),!c&&Object(l.jsx)(f.a,{trigger:Object(l.jsx)(O.a,{negative:!0,content:t(".delete_locale")}),content:Object(l.jsx)(O.a,{negative:!0,content:t(".confirm_delete_locale"),onClick:ee(Q,Y,e)}),on:"click",position:"top center"})]})})})]})]})})}}),Object(l.jsx)(b.a,{as:"h3",content:t(".hitokoto")}),Object(l.jsx)(H.a,{className:g.a.configEditor,language:"yaml",value:ce,onChange:function(e){return ae(e)}}),Object(l.jsx)(b.a,{as:"h3",content:t(".countdown")}),Object(l.jsx)(H.a,{className:g.a.configEditor,language:"yaml",value:oe,onChange:function(e){return ie(e)}}),Object(l.jsx)(b.a,{as:"h3",content:t(".friend_links")}),Object(l.jsx)(H.a,{className:g.a.configEditor,language:"yaml",value:ue,onChange:function(e){return be(e)}}),Object(l.jsx)("div",{className:g.a.bottomSubmitWrapper,children:Object(l.jsx)(O.a,{loading:fe,primary:!0,content:t(".submit"),onClick:he})})]})};t.default=Object(v.c)(function(){var e=Object(j.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l.jsx,e.t1=B,e.t2=s.a,e.t3={},e.next=6,R();case 6:return e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.abrupt("return",(0,e.t0)(e.t1,e.t5));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=149.2322ad33.chunk.js.map